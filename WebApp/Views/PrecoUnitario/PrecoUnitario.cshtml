@{
    ViewBag.Title = "::.. Preços Unitários ..::";
}

@model List<WebApp.Models.Usuario>
@using WebApp.Models
@{
    //Verifica se o usuário esta logado
    if (Session["Usuario"] == null)
    {
        Html.Action("LogSistema_Salvar", "LogSistema", new { mod_id = 460 });
       Response.Redirect("~/AcessoNegado/AcessoNegado");
    }

    Usuario gUsuario = (Usuario)Session["Usuario"];
    List<UsuarioPermissoes> lstPermissoes = gUsuario.lstUsuarioPermissoes;
    UsuarioPermissoes permissoesDesteModulo = lstPermissoes.Find(x => x.mod_id.Equals(460)); // 460 = id DO MODULO "Integração com o Sistema TPU"
    if (permissoesDesteModulo == null)
    {
        Html.Action("LogSistema_Salvar", "LogSistema", new { mod_id = 460 });
       Response.Redirect("~/AcessoNegado/AcessoNegado");
    }
}

<h2></h2>
<div style="width:90%; margin:0 auto;">

    <div class="form-group">
        <div class="row" style="margin:10px;">
            <label class="control-label col-sm-2" style="text-align:right;">Filtrar por Data de Referência</label>
            <div class="col-sm-10  " style="padding-left:0px; ">
                @Html.DropDownList("cmbDatasReferencia", null, string.Empty, new { @class = "form-control", @onchange = "cmbDatasReferencia_onchange()" })
            </div>
        </div>

        <div class="row" style="margin:10px;">
            <label class="control-label col-sm-2" style="text-align:right;">Filtrar por Fase</label>
            <div class="col-sm-10  " style="padding-left:0px; ">
                @Html.DropDownList("cmbFase", null, string.Empty, new { @class = "form-control", @onchange = "cmbFase_onchange()" })
            </div>
        </div>

        <div class="row" style="margin:10px;">
            <label class="control-label col-sm-2" style="text-align:right;">Filtrar por Tipo</label>
            <div class="col-sm-10" style="padding-left:0px; ">
                <label class="radio-inline">
                    <input type="radio" name="radio" id="rd_X" value="x" onchange="filtrarTipo(value)" checked>Todos
                </label>
                <label class="radio-inline">
                    <input type="radio" name="radio" id="rd_O" value="O" onchange="filtrarTipo(value)">Onerado
                </label>
                <label class="radio-inline">
                    <input type="radio" name="radio" id="rd_D" value="D" onchange="filtrarTipo(value)">Desonerado
                </label>
            </div>
        </div>

    </div>



    <table id="tblPrecos_Unitarios">
        <thead>
            <tr>
                <th colspan="8">
                    <label>Localizar </label>

                    <input id="txtLocalizarTPU" type="search" class="form-control" style="width:350px; display:inline"
                           onkeyup="$('#tblPrecos_Unitarios').DataTable().search( this.value ).draw();">
                    <i class="fa fa-search"></i>

                    <a href="#" onclick="LimparFiltro()"><span class="glyphicon glyphicon-remove text-danger"></span></a>

                </th>
            </tr>

            <tr>
                <th>tpu_id</th>
                <th>Fase</th>
                <th>Tipo</th>
                <th>Código DER</th>
                <th>Descrição</th>
                <th>Unidade</th>
                <th>Preço Unitário</th>
                <th>Opções</th>
            </tr>
        </thead>
    </table>

    <br /><br />
    <input type="hidden" id="hddnSelectedtpu_id" name="hddnSelectedtpu_id" value="-1" />

</div>


<link href="~/Content/Gerais.css" rel="stylesheet" />
<link href="~/Content/font-awesome.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/jquery.dataTables.min.css" rel="stylesheet" />
<script src="~/Content/plugins/sweetalert2.min.js"></script>

@section Scripts{
    <script>
        var permissaoLeitura = parseInt(@permissoesDesteModulo.mfl_leitura);
        var permissaoEscrita = parseInt(@permissoesDesteModulo.mfl_escrita);
        var permissaoInsercao = parseInt(@permissoesDesteModulo.mfl_inserir);
        var permissaoExclusao = parseInt(@permissoesDesteModulo.mfl_excluir);
    </script>

}
<script src="~/Scripts/Base.js"></script>
<script src="~/Scripts/PrecoUnitario/PrecoUnitario.js"></script>


