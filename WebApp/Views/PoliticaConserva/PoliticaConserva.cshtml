
@{
    ViewBag.Title = "::.. PoliticaConserva ..::";
}

@using WebApp.Models


@{
    //Verifica se o usuário esta logado
    if (Session["Usuario"] == null)
    {
        Html.Action("LogSistema_Salvar", "LogSistema", new { mod_id = 540 });
        Response.Redirect("~/AcessoNegado/AcessoNegado");
    }

    Usuario gUsuario = (Usuario)Session["Usuario"];
    List<UsuarioPermissoes> lstPermissoes = gUsuario.lstUsuarioPermissoes;
    UsuarioPermissoes permissoesDesteModulo = lstPermissoes.Find(x => x.mod_id.Equals(540)); // id DO MODULO "O.S."
    if (permissoesDesteModulo == null)
    {
        Html.Action("LogSistema_Salvar", "LogSistema", new { mod_id = 540 });
        Response.Redirect("~/AcessoNegado/AcessoNegado");
    }
}
@section Scripts{
    <script>
        var permissaoLeitura = parseInt(@permissoesDesteModulo.mfl_leitura);
        var permissaoEscrita = parseInt(@permissoesDesteModulo.mfl_escrita);
        var permissaoInsercao = parseInt(@permissoesDesteModulo.mfl_inserir);
        var permissaoExclusao = parseInt(@permissoesDesteModulo.mfl_excluir);
    </script>
    <script src="~/Scripts/Base.js"></script>
    <script src="~/Scripts/Shared/_PolitacaConserva.js"></script>
    <script src="~/Scripts/Politica/Politica.js"></script>
    <script>
        var selectedId_obj_id;

        function btnOSInserir_onclick() {

            $("#modalSalvarRegistro").modal('show');

        }

    </script>

}



<div style="width:100%;" id="divFiltros">
    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title">Localizar</h3>
        </div>
        <div class="box-body">
            <div id="divcontroles" class="row" style="margin:3px">
                <div class="row">
                    <div class="form-group">
                        <div class="col-sm-3">
                            <label class="control-label">SubDivisão 1:</label>
                            <select name="cmbSub1" id="cmbSub1" class="form-control"
                                    onchange="cmbSub1Proximo_onchange()">
                                <option value="-1" selected disabled>-- Selecione --</option>
                                <option value="11">Superestrutura</option>
                                <option value="12">Mesoestrutura</option>
                                <option value="13">Infraestrutura</option>
                                <option value="14">Encontro</option>
                            </select>
                        </div>
                        <div class="col-sm-3" id="cmbSub2Div">
                            <div>
                                <label class="control-label">SubDivisão 2:</label>
                                <select name="cmbSub2" id="cmbSub2" class="form-control" onchange="cmbSub2_onchange()">
                                    <option value="">--Selecione--</option>
                                </select>
                            </div>

                        </div>
                        <div class="col-sm-3 " id="cmbSub3Div">
                            <div>
                                <label class="control-label">SubDivisão 3:</label>
                                <select name="cmbSub3" id="cmbSub3" class="form-control" onchange="cmbSub3_onchange()">
                                    <option value="">--Selecione--</option>
                                </select>
                            </div>

                        </div>
                        <div class="col-sm-3">
                            <label class="control-label">Grupos de Objetos:</label>
                            <select name="cmbGrupos" id="cmbGrupos" class="form-control" onchange="cmbGrupos_onchange()">
                                <option value="">--Selecione--</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group" style="padding-top:20px; margin-top:20px">
                        <div class="col-sm-3">
                            <label class="control-label">Variavel de Inspeção:</label>
                            <select name="cmbVarInspec" id="cmbVarInspec" class="form-control">
                                <option value="">--Selecione--</option>
                            </select>
                        </div>
                        <div class="btn-box-tool pull-right" style="margin-top:20px">
                            <button type="submit" class="btn btn-primary" onclick="pesquisar_click();" style="margin-right: 10px !important;"><i class="fa fa-search margin-r-5"></i> Pesquisar</button>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

<section class="content" style="min-height: 50px;">
    <div class="row">
        <div class="box box-primary">
            <div class="box-body">
                <table id="tblSubs" class="no-footer dataTable">
                    <thead>
                        <tr>
                            <th style="width:110px">Sub 1</th>
                            <th style="width:110px">Sub 2</th>
                            <th style="width:80px">Sub 3</th>
                            <th style="width:110px">Objetos</th>
                            <th>Tipo</th>
                            <th>Alerta</th>
                            <th>Conserva</th>
                            <th style="text-align:center">Opções</th>

                        </tr>
                    </thead>
                    <tbody id="corpo">
                    </tbody>
                </table>
                @{
                    if ((permissoesDesteModulo != null) && (permissoesDesteModulo.mfl_inserir > 0))
                    {
                        <button type="button" class="btn btn-primary botaoInserir" onclick="btnOSInserir_onclick();">Nova Politica de Conserva</button>
                    }
                }
                <input type="hidden" id="hddnSelectedord_id" name="hddnSelectedord_id" value="-1" />
            </div>
        </div>
    </div>
</section>

<div class="modal fade" id="modalSalvarRegistro" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" style="width:850px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title text-center"><b><label id="lblModalHeader">Nova Politica de Conserva</label></b></h3>
            </div>
            <form class="form-horizontal" onkeydown="if (event.keyCode == 13) { event.preventDefault(); return false; }">
                <br />
                <div class="modal-body form-group">
                    <div class="col-sm-12">
                        <div id="Ficha2_divSubdivisao1" class="form-group">
                            <label class="control-label col-sm-3">Subdivisão 1</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="Ficha2_cmbSubdivisao1" name="Ficha2_cmbSubdivisao1"
                                        onchange="Ficha2_cmbSubdivisao1_onchange()"
                                        placeholder="Subdivisão 1">
                                    <option value="-1" selected disabled>-- Selecione --</option>
                                    <option value="11">Superestrutura</option>
                                    <option value="12">Mesoestrutura</option>
                                    <option value="13">Infraestrutura</option>
                                    <option value="14">Encontro</option>
                                </select>
                            </div>
                        </div>

                        <div id="Ficha2_divSubdivisao2" class="form-group" style="display:none">
                            <label class="control-label col-sm-3">Subdivisão 2</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="Ficha2_cmbSubdivisao2" name="Ficha2_cmbSubdivisao2"
                                        onchange="Ficha2_cmbSubdivisao2_onchange()"
                                        placeholder="Subdivisão 2"></select>
                            </div>
                        </div>

                        <div id="Ficha2_divSubdivisao3" class="form-group" style="display:none">
                            <label class="control-label col-sm-3">Subdivisão 3</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="Ficha2_cmbSubdivisao3" name="Ficha2_cmbSubdivisao3"
                                        onchange="Ficha2_cmbSubdivisao3_onchange()"
                                        placeholder="Subdivisão 3"></select>
                            </div>
                        </div>
                        <div class="form-group" id="divFicha2_GrupoObjetos">
                            <label class="control-label col-sm-3">Grupo de Objetos</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="cmbFicha2_GrupoObjetos" name="cmbFicha2_GrupoObjetos"
                                        onchange="cmbFicha2_GrupoObjetosModal_onchange()"
                                        placeholder="Grupo de Objetos">
                                    <option value="">--Selecione--</option>
                                </select>

                            </div>
                        </div>

                        <div class="form-group">
                            <label class="control-label col-sm-3">Variavel de Inspeção</label>
                            <div class="col-sm-8">
                                <select name="cmbVrInspec11" id="cmbVrInspec11" class="form-control" onchange="preencheConserva_onchange()">
                                    <option value="">--Selecione--</option>
                                </select>
                            </div>
                        </div>
                        <hr style="width:100%" />
                        <div class="form-group">
                            <input type="hidden" id="ocp_id2" />
                            <label class="control-label col-sm-3">Normal</label>
                            <div class="col-sm-4">
                                <textarea class="form-control" placeholder="Descrição do Alerta" id="txtAlerta2" style="width:274px; height:68px"></textarea>
                            </div>
                            <div class="col-sm-4">
                                <textarea class="form-control" placeholder="Conserva" id="descri2" style="width:274px; height:68px"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <input type="hidden" id="ocp_id1" />
                            <label class="control-label col-sm-3">Atenção</label>
                            <div class="col-sm-4">
                                <textarea type="text" class="form-control" placeholder="Descrição do Alerta" id="txtAlerta1" style="width:274px; height:68px"></textarea>
                            </div>
                            <div class="col-sm-4">
                                <textarea type="text" class="form-control" placeholder="Conserva" id="descri1" style="width:274px; height:68px"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <input type="hidden" id="ocp_id3" />
                            <label class="control-label col-sm-3">Critíca</label>
                            <div class="col-sm-4">
                                <textarea type="text" class="form-control" placeholder="Descrição do Alerta" id="txtAlerta3" style="width:274px; height:68px"></textarea>
                            </div>
                            <div class="col-sm-4">
                                <textarea type="text" class="form-control" placeholder="Conserva" id="descri3" style="width:274px; height:68px"></textarea>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="col-md-3 col-md-offset-4">
                        <button id="bntSalvar" name="bntSalvar_Novo" onclick="return updateConserva_Click();" class="btn btn-primary btn-block btn-flat">Salvar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="modalEdit" tabindex="-1" role="dialog" aria-labelledby="myModalLabelEdit">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" style="width:850px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title text-center"><b><label id="lblModalHeader">Editar Politica de Conserva</label></b></h3>
            </div>
            <form class="form-horizontal" onkeydown="if (event.keyCode == 13) { event.preventDefault(); return false; }">
                <br />
                <div class="modal-body form-group">
                    <div class="col-sm-12">

                        <div class="form-group">
                            <input type="hidden" id="ocp_idEdit" />
                            <label class="control-label col-sm-3">Conserva</label>
                            <div class="col-sm-4">
                                <textarea class="form-control" placeholder="Descrição do Alerta" id="descricaoEdit" style="width:270px;height:80px"></textarea>
                            </div>
                            <div class="col-sm-4">
                                <textarea class="form-control" placeholder="Conserva" id="conservaEdit" style="width:270px;height:80px"></textarea>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <div class="col-md-3 col-md-offset-4">
                        <button id="bntSalvarEdit" onclick="return btnEditSalvar_onclick();" class="btn btn-primary btn-block btn-flat">Atualizar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<link href="~/Content/Gerais.css" rel="stylesheet" />
<link href="~/Content/font-awesome.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/jquery.dataTables.min.css" rel="stylesheet" />
<script src="~/Content/plugins/sweetalert2.min.js"></script>
<script src="~/Scripts/jquery-ui.js"></script>
<link href="~/Scripts/jquery-ui.css" rel="stylesheet" />
<script src="~/Scripts/moment.min.js"></script>
<script src="~/Scripts/datetime-moment.js"></script>
